mqtt:
  name: sxvrs
  topic_publish  : sxvrs/{source_name}
  topic_subscribe: sxvrs/{source_name}
  server_ip: 127.0.0.1

global:
  record_autostart: False
  ip: 127.0.0.1
  stream_url: "rtsp://{ip}:5544/live0.264"
  record_time: 30 # Seconds
  storage_max_size: 10 # GBytes
  storage_path: storage/{name}/{datetime:%Y-%m-%d}
  filename: "{storage_path}/{name}_{datetime:%Y%m%d_%H%M%S}.ts"
  cmd_before:
  cmd:
  cmd_after:
  snapshot_filename: storage/{name}/snapshot.jpeg
  snapshot_cmd: ffmpeg -hide_banner -ss 2 -i "{last_recorded_filename}" -y -f image2 -qscale 0 -frames 1 "{snapshot_filename}"
  start_error_atempt_cnt: 10 # If process will not able to start for this number attempts, then it will go to sleep
  start_error_threshold: 10 # Minimum number of seconds, to understand that process is started normally
  start_error_sleep: 600 # Number of seconds to sleep on error

sources:
  camera_1: #Source name
    record_autostart: True
    ip: 192.168.1.10
    storage_max_size: 1 #GB
    stream_url: rtsp://wowzaec2demo.streamlock.net/vod/mp4:BigBuckBunny_115k.mov
    cmd: ffmpeg -hide_banner -nostdin -nostats -fflags +igndts -y -i "{stream_url}" -c:v copy -t {record_time} -copytb 1 "{filename}"

logger:
  version: 1
  disable_existing_loggers: False
  formatters:
      simple:
          format: "%(asctime)s - %(name)s [%(levelname)s]: \t %(message)s"
  handlers:
      console:
          class: logging.StreamHandler
          level: DEBUG
          formatter: simple
          stream: ext://sys.stdout

      info_file_handler:
          class: logging.handlers.RotatingFileHandler
          level: INFO
          formatter: simple
          filename: logs/sxvrs.log
          maxBytes: 10485760 # 10MB
          backupCount: 10
          encoding: utf8

      error_file_handler:
          class: logging.handlers.RotatingFileHandler
          level: ERROR
          formatter: simple
          filename: logs/sxvrs.err
          maxBytes: 10485760 # 10MB
          backupCount: 10
          encoding: utf8

  root:
      level: DEBUG
      handlers: [console, info_file_handler, error_file_handler]